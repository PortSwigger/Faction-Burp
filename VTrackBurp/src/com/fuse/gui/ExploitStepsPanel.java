package com.fuse.gui;

import java.util.List;

import javax.swing.JFrame;
import javax.swing.JPanel;

import java.awt.GridBagLayout;

import javax.swing.JLabel;

import java.awt.GridBagConstraints;

import javax.swing.JScrollPane;

import java.awt.Insets;

import javax.swing.JEditorPane;
import javax.swing.border.TitledBorder;
import javax.swing.border.LineBorder;

import java.awt.Color;
import java.io.UnsupportedEncodingException;
import java.awt.Font;

public class ExploitStepsPanel extends JFrame{
	private String Description;
	private String Recommendation;
	private List<String> Steps;
	private List<String> Images;
	private String Name;
	
	public ExploitStepsPanel(String Name, String Description, String Recommendation, List<String> Steps, List<String> Images){
		this.Description = Description;
		this.Recommendation = Recommendation;
		this.Steps = Steps;
		this.Images = Images;
		this.Name = Name;
		GridBagLayout gridBagLayout = new GridBagLayout();
		gridBagLayout.columnWidths = new int[]{0, 0, 0};
		gridBagLayout.rowHeights = new int[]{20, 50, 257, 0};
		gridBagLayout.columnWeights = new double[]{1.0, 1.0, Double.MIN_VALUE};
		gridBagLayout.rowWeights = new double[]{0.0, 0.0, 1.0, Double.MIN_VALUE};
		getContentPane().setLayout(gridBagLayout);
		
		JLabel nameTxt = new JLabel("New label");
		nameTxt.setFont(new Font("Arial", Font.BOLD, 20));
		GridBagConstraints gbc_nameTxt = new GridBagConstraints();
		gbc_nameTxt.gridwidth = 2;
		gbc_nameTxt.anchor = GridBagConstraints.NORTH;
		gbc_nameTxt.insets = new Insets(0, 0, 5, 5);
		gbc_nameTxt.gridx = 0;
		gbc_nameTxt.gridy = 0;
		getContentPane().add(nameTxt, gbc_nameTxt);
		
		JPanel panel = new JPanel();
		panel.setBorder(new TitledBorder(new LineBorder(new Color(184, 207, 229)), "Description", TitledBorder.LEADING, TitledBorder.TOP, null, new Color(51, 51, 51)));
		GridBagConstraints gbc_panel = new GridBagConstraints();
		gbc_panel.fill = GridBagConstraints.BOTH;
		gbc_panel.insets = new Insets(0, 0, 5, 5);
		gbc_panel.gridx = 0;
		gbc_panel.gridy = 1;
		getContentPane().add(panel, gbc_panel);
		GridBagLayout gbl_panel = new GridBagLayout();
		gbl_panel.columnWidths = new int[]{0, 0};
		gbl_panel.rowHeights = new int[]{0, 0};
		gbl_panel.columnWeights = new double[]{1.0, Double.MIN_VALUE};
		gbl_panel.rowWeights = new double[]{1.0, Double.MIN_VALUE};
		panel.setLayout(gbl_panel);
		
		JScrollPane scrollPane = new JScrollPane();
		GridBagConstraints gbc_scrollPane = new GridBagConstraints();
		gbc_scrollPane.fill = GridBagConstraints.BOTH;
		gbc_scrollPane.gridx = 0;
		gbc_scrollPane.gridy = 0;
		panel.add(scrollPane, gbc_scrollPane);
		
		JEditorPane descTxt = new JEditorPane();
		descTxt.setContentType("text/html");
		scrollPane.setViewportView(descTxt);
		
		JPanel panel_1 = new JPanel();
		panel_1.setBorder(new TitledBorder(new LineBorder(new Color(184, 207, 229)), "Recommendation", TitledBorder.LEADING, TitledBorder.TOP, null, new Color(51, 51, 51)));
		GridBagConstraints gbc_panel_1 = new GridBagConstraints();
		gbc_panel_1.fill = GridBagConstraints.BOTH;
		gbc_panel_1.insets = new Insets(0, 0, 5, 0);
		gbc_panel_1.gridx = 1;
		gbc_panel_1.gridy = 1;
		getContentPane().add(panel_1, gbc_panel_1);
		GridBagLayout gbl_panel_1 = new GridBagLayout();
		gbl_panel_1.columnWidths = new int[]{0, 0};
		gbl_panel_1.rowHeights = new int[]{182, 0};
		gbl_panel_1.columnWeights = new double[]{1.0, Double.MIN_VALUE};
		gbl_panel_1.rowWeights = new double[]{1.0, Double.MIN_VALUE};
		panel_1.setLayout(gbl_panel_1);
		
		JScrollPane scrollPane_1 = new JScrollPane();
		GridBagConstraints gbc_scrollPane_1 = new GridBagConstraints();
		gbc_scrollPane_1.fill = GridBagConstraints.BOTH;
		gbc_scrollPane_1.gridx = 0;
		gbc_scrollPane_1.gridy = 0;
		panel_1.add(scrollPane_1, gbc_scrollPane_1);
		
		JEditorPane recTxt = new JEditorPane();
		recTxt.setContentType("text/html");
		scrollPane_1.setViewportView(recTxt);
		recTxt.setText(this.Recommendation);
		
		JPanel panel_2 = new JPanel();
		panel_2.setBorder(new TitledBorder(new LineBorder(new Color(184, 207, 229)), "Exploit Steps", TitledBorder.LEADING, TitledBorder.TOP, null, new Color(51, 51, 51)));
		GridBagConstraints gbc_panel_2 = new GridBagConstraints();
		gbc_panel_2.gridwidth = 2;
		gbc_panel_2.fill = GridBagConstraints.BOTH;
		gbc_panel_2.gridx = 0;
		gbc_panel_2.gridy = 2;
		getContentPane().add(panel_2, gbc_panel_2);
		GridBagLayout gbl_panel_2 = new GridBagLayout();
		gbl_panel_2.columnWidths = new int[]{0, 0};
		gbl_panel_2.rowHeights = new int[]{257, 0};
		gbl_panel_2.columnWeights = new double[]{1.0, Double.MIN_VALUE};
		gbl_panel_2.rowWeights = new double[]{1.0, Double.MIN_VALUE};
		panel_2.setLayout(gbl_panel_2);
		
		JScrollPane scrollPane_2 = new JScrollPane();
		GridBagConstraints gbc_scrollPane_2 = new GridBagConstraints();
		gbc_scrollPane_2.fill = GridBagConstraints.BOTH;
		gbc_scrollPane_2.gridx = 0;
		gbc_scrollPane_2.gridy = 0;
		panel_2.add(scrollPane_2, gbc_scrollPane_2);
		
		JEditorPane stepsTxt = new JEditorPane();
		
		stepsTxt.setContentType("text/html");
		scrollPane_2.setViewportView(stepsTxt);
		
		//Update the form
		descTxt.setText(this.Description);
		nameTxt.setText(this.Name);
		String HTML="";
		if(this.Steps != null){
			for(int i=0; i< this.Steps.size(); i++){
				HTML = HTML + "<hr> <h1><u>Example " + i + "</u></h1><br>" + this.Steps.get(i).replace("#eee", "#eeeeee") + "<br>";
				if(this.Images.get(i) != null || !this.Images.get(i).equals("")){
					try {
						//System.out.println(java.net.URLDecoder.decode(this.Images.get(i), "UTF-8").replace(" ", "+") );
						HTML +="<center><img src='data:image/jpg;base64," + java.net.URLDecoder.decode(this.Images.get(i), "UTF-8").replace(" ", "+") +"'></img></center>";
					} catch (UnsupportedEncodingException e) {
						// TODO Auto-generated catch block
						e.printStackTrace();
					}
				}
				
				
			}
		}
		//System.out.println(HTML);
		stepsTxt.setText(HTML);
		
	}
	

}
